conf_file: /etc/salt/master
log_level: {{ log_level }}

root_dir: /

master_id: {{ id }}
saltenv: {{ saltenv }}
pillarenv: {{ pillarenv }}

# Network configuration
ipv6: false
transport: zeromq

# Options
yaml_utf8: true
verify_env: true
state_output_diff: false

runner_returns: true
# presence_events: true
state_events: true

auto_accept: true

# Job configuration
cli_summary: true
job_cache_store_endtime: true

cache: etcd
master_job_cache: etcd
ext_job_cache: etcd

# File-server configuration
file_recv_max_size: 512

fileserver_backend:
    - roots

# Pillar configuration
pillar_opts: true
pillar_raise_on_missing: false
# pillarenv_from_saltenv: true

# Etcd cache
{%- for field in etcd_cache %}
etcd.{{ field }}: {{ etcd_cache[field] }}
{%- endfor %}

# Etcd hosts
{%- for etcd in etcd_hosts %}
{{ etcd.name }}:
    etcd.host: {{ etcd.host }}
    etcd.port: {{ etcd.port }}
{% endfor %}

# Files
file_roots:
    {%- for root in root_files %}
    {{ root.name }}:
        - {{ root.path }}
    {%- endfor %}

# Pillars
pillar_roots:
    {%- for pillar in root_pillars %}
    {{ pillar.name }}:
        - {{ pillar.path }}
    {%- endfor %}

ext_pillar:
    {%- for pillar in etcd_pillars_ext %}
    - etcd: {{ pillar.name }} root={{ pillar.path }}
    {%- endfor %}

# Returners
event_return:
    - etcd

{% for field in etcd_returner %}
etcd.{{ field }}: {{ etcd_returner[field] }}
{%- endfor %}
