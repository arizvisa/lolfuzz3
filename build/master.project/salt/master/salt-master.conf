# Generic configuration
root_dir: /
log_level: warning
conf_file: /etc/salt/master

transport: zeromq

# Network binding
interface: '::'
ipv6: True

# Options
yaml_utf8: True
verify_env: True
cache: localfs

state_output_diff: False
presence_events: True
state_events: True
auto_accept: True

# Job configuration
show_jid: True
cli_summary: True
master_job_cache: etcd
job_cache_store_endtime: True

# File-server configuration
file_recv_max_size: 512

fileserver_backend:
    - roots
file_roots:
    {%- for root in root_files %}
    {{ root.name }}:
        - {{ root.path }}
    {%- endfor %}

# Pillar configuration
pillarenv_from_saltenv: True
pillar_opts: True
pillar_raise_on_missing: True
ext_pillar_first: True

# Pillars
pillar_roots:
    {%- for pillar in root_pillars %}
    {{ pillar.name }}:
        - {{ pillar.path }}
    {%- endfor %}

{%- for pillar in etcd_pillars %}
{{ pillar.name }}:
    etcd.host: {{ pillar.host }}
    etcd.port: {{ pillar.port }}
{% endfor -%}

{%- for pillar in etcd_returners %}
etcd.returner: {{ pillar.name }}
etcd.returner_root: {{ pillar.path }}
{%- endfor %}

ext_pillar:
    {%- for pillar in etcd_pillars_ext %}
    - etcd: {{ pillar.name }} root={{ pillar.path }}
    {%- endfor %}

# Grain configuration
grains:
    minion-role: master
