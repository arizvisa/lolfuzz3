## Variables
# DEFAULT_IPV4 comes from /etc/network-environment
# BOOTSTRAP_ID comes from /etc/bootstrap-environment

[Service]
ExecStart=
ExecStart=/bin/sh -c 'exec /usr/lib/coreos/etcd-wrapper \
          --name=$(cat /etc/machine-id) \
          --listen-peer-urls="http://0.0.0.0:2380" \
          --initial-advertise-peer-urls="http://${DEFAULT_IPV4}:2380" \
          --listen-client-urls="http://0.0.0.0:4001" \
          --advertise-client-urls="http://${DEFAULT_IPV4}:4001" \
          --discovery "http://${BOOTSTRAP_IPV4}:4001/v2/keys/${BOOTSTRAP_ID}" \
          --discovery-fallback=exit \
          '
