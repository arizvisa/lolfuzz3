## Notes
# This service is responsible for creating a new etcd cluster and running etcd
# so that one can register the discovery URL. The name of the initial etcd
# instance is the same as /etc/machine-id and as so, this file is required
# in order for the instance to determine its name.

## Variables
# DEFAULT_IPV4 comes from /etc/network-environment
# BOOTSTRAP_ID comes from /etc/bootstrap-environment

[Service]
Slice=machine.slice
ExecStart=
ExecStart=/bin/sh -c 'exec /lib/coreos/etcd-wrapper \
            --name=$(cat /etc/machine-id) \
            --listen-client-urls="http://0.0.0.0:2379" \
            --advertise-client-urls="http://127.0.0.1:2379" \
            --listen-peer-urls="http://0.0.0.0:2380" \
            --initial-cluster-state=new \
            --initial-advertise-peer-urls="http://127.0.0.1:2380" \
            --initial-cluster=$(cat /etc/machine-id)="http://127.0.0.1:2380" \
            '
