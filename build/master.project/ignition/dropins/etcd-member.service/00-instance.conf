## Notes
# This service will check to see if the BOOTSTRAP_ID matches /etc/machine-id.
# If so, then there's only one instance of etcd on the cluster and we should be
# running the etcd-master.service. The different between this service and
# etcd-master.service is that the discovery-url is built from the
# /etc/bootstrap-environment file.

## Variables
# DEFAULT_IPV4 comes from /etc/network-environment

[Service]
Environment="ETCD_DATA_DIR=/var/lib/etcd"

Slice=machine.slice
ExecStart=
ExecStart=/bin/sh -c 'exec /lib/coreos/etcd-wrapper \
          --enable-v2 \
          --listen-client-urls="http://0.0.0.0:2379" \
          --advertise-client-urls="http://${DEFAULT_IPV4}:2379" \
          --listen-peer-urls="http://0.0.0.0:2380" \
          --initial-advertise-peer-urls="http://${DEFAULT_IPV4}:2380" \
          '
